<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<meta name="robots" content="noindex, nofollow" />

<title>AI ëŒ€í™”í˜• ë‹¬ë ¥Â·ë‹¤ì´ì–´ë¦¬ ì¶”ì²œ (2026Â·Full Popup / ì •ë¦¬ë³¸)</title>
<link rel="preconnect" href="https://cdn.jsdelivr.net"/>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/orioncactus/pretendard@v1.3.9/dist/web/variable/pretendardvariable-dynamic-subset.css"/>
<style>
:root{
  --bg:#f7f7f8; --panel:#ffffff; --ink:#1f2937; --muted:#6b7280;
  --brand:#3b82f6; --brand-ink:#fff; --shadow:0 6px 30px rgba(0,0,0,.08);
}
*{box-sizing:border-box}
body{margin:0;background:var(--bg);color:var(--ink);
  font-family:"Pretendard Variable","Pretendard",system-ui,-apple-system,Segoe UI,Roboto,Noto Sans KR,Apple SD Gothic Neo,"Malgun Gothic",sans-serif}
header{position:sticky;top:0;z-index:10;backdrop-filter:saturate(1.2) blur(6px);
  background:linear-gradient(180deg,rgba(247,247,248,.9),rgba(247,247,248,.65));border-bottom:1px solid #e5e7eb}
.wrap{max-width:1000px;margin:0 auto;padding:20px}
.bar{display:flex;align-items:center;gap:12px;padding:14px 20px}
.logo{font-weight:800;font-size:18px}
.chip{background:#eef2ff;color:#3730a3;padding:4px 10px;border-radius:999px;font-size:12px}

main{display:grid;grid-template-columns:1fr;gap:16px;padding:16px}
@media(min-width:900px){ 
  main{
    grid-template-columns: 1fr 180px; /* âœ… ì˜¤ë¥¸ìª½ í­ ì ˆë°˜ìœ¼ë¡œ */
    align-items: start;
  } 
}

.panel{background:var(--panel);border-radius:16px;box-shadow:var(--shadow);overflow:hidden}

/* Chat */
.chat {
  flex: 1;
  overflow-y: auto;
  padding: 18px;
  scroll-behavior: smooth;
}

.row{display:flex;gap:10px;margin:12px 0}
.avatar{width:34px;height:34px;border-radius:50%;background:#e5e7eb;display:flex;align-items:center;justify-content:center;font-weight:700}
.bubble{max-width:82%;padding:12px 14px;border-radius:14px;line-height:1.55;font-size:15px;box-shadow:0 2px 10px rgba(0,0,0,.04)}
.ai{background:#f1f5f9;border-top-left-radius:6px}
.me{background:#e0f2fe;border-top-right-radius:6px;margin-left:auto}

/* Composer */
.composer{position:sticky;bottom:0;background:linear-gradient(180deg,transparent,var(--panel));padding:14px 18px}

.choices{display:flex;flex-wrap:wrap;gap:10px;margin:8px 0 0}
.pill{border:1px solid #e5e7eb;background:#fff;padding:8px 12px;border-radius:999px;font-size:13px;cursor:pointer}
.pill:hover{border-color:#d1d5db}

/* Product deck */
.deck{padding:14px;display:grid;grid-template-columns:repeat(2, 1fr);gap:12px}
@media(min-width:540px){.deck{grid-template-columns:repeat(3, 1fr)}}
.card{border:1px solid #eef2f7;border-radius:14px;overflow:hidden;background:#fff;display:flex;flex-direction:column}
.thumb-wrap{position:relative}
.thumb{display:flex;align-items:center;justify-content:center;padding:6px;background:#fff}
.thumb img{max-width:100%;max-height:220px;object-fit:contain;display:block;border-radius:8px;cursor:pointer;transition:transform .2s}
.thumb img:hover{transform:scale(1.02)}
.badge{position:absolute;top:10px;left:10px;background:#ef4444;color:#fff;font-size:11px;padding:4px 6px;border-radius:8px}
.meta{padding:10px 12px}
.name{font-weight:800;font-size:14px}
.tagline{color:var(--muted);font-size:12px;margin-top:4px;min-height:1.2em}
.tags{display:flex;flex-wrap:wrap;gap:6px;margin-top:8px}
.tag{font-size:11px;background:#f3f4f6;border-radius:999px;padding:4px 8px}

/* Price block (badge up top + line under) */
.price{display:flex;flex-direction:column;align-items:flex-start;gap:4px;margin-top:8px}
.sale{background:#fde68a;color:#92400e;border-radius:6px;padding:3px 8px;font-size:11px;font-weight:600;white-space:nowrap}
.price-line{font-size:15px;font-weight:600;color:#111827}
.price-line del{color:#9ca3af;margin-right:6px;font-size:14px}
.price-line .sale-amount{color:#dc2626;font-weight:700}

/* right rail */
.rail{display:flex;flex-direction:column;gap:16px}
.rail .box{background:var(--panel);border-radius:16px;box-shadow:var(--shadow);padding:14px}
.rail h3{margin:0 0 8px;font-size:16px}
/* ---------- ì˜¤ë¥¸ìª½ íŒ¨ë„ (ì„¸ë¡œí˜•, ì¢ê³  ê¸´ êµ¬ì„±) ---------- */
/* right rail (ì„¸ë¡œí˜•, ì¢ê³  ê¸´ êµ¬ì„±) */
/* ê¸°ì¡´ì— ìˆë˜ ì˜¤ë¥¸ìª½ rail ì •ì˜ */
.rail {
  display: flex;
  flex-direction: column;
  gap: 16px;
  height: 78vh;
  overflow-y: auto;
  scrollbar-width: thin;
  scrollbar-color: #d1d5db transparent;
}

/* âœ… ì—¬ê¸°ì— ì•„ë˜ ì½”ë“œ ë¶™ì—¬ë„£ê¸° */
@media (min-width: 1100px) {
  main {
    display: grid;
    grid-template-columns: 1fr 180px;
    gap: 16px;
  }
}
.rail .box {
  background: var(--panel);
  border-radius: 16px;
  box-shadow: var(--shadow);
  padding: 14px;
}

.rail h3 {
  margin: 0 0 8px;
  font-size: 16px;
}
/* ìŠ¤í¬ë¡¤ë°” ì‚´ì§ ì–‡ê²Œ */
.rail::-webkit-scrollbar {
  width: 6px;
}
.rail::-webkit-scrollbar-thumb {
  background-color: #cbd5e1;
  border-radius: 6px;
}
/* ìš°ì¸¡ í•„í„° ê·¸ë£¹ ì†Œì œëª© */
.rail .subhead{
  margin: 10px 0 6px;
  font-size: 12.5px;
  font-weight: 700;
  color: var(--muted);
  letter-spacing: .2px;
}

/* helper */
.helper{display:flex;align-items:center;gap:8px;padding:10px 12px;background:#f8fafc;border-top:1px solid #e5e7eb;font-size:12px;color:#475569}

/* typing dots */
.dots{display:inline-flex;gap:4px;vertical-align:middle;margin-left:2px}
.dots i{width:6px;height:6px;background:#94a3b8;border-radius:50%;display:inline-block;opacity:.35;animation:blink 1s infinite}
.dots i:nth-child(2){animation-delay:.15s}
.dots i:nth-child(3){animation-delay:.3s}
@keyframes blink{0%,80%,100%{opacity:.2}40%{opacity:1}}

/* Popup modal */
#popupOverlay{position:fixed;inset:0;background:rgba(0,0,0,0.55);backdrop-filter:blur(3px);display:none;align-items:center;justify-content:center;z-index:200}
#popupBox{background:#fff;border-radius:12px;max-width:860px;width:92%;max-height:90vh;overflow:auto;box-shadow:var(--shadow);position:relative}
.closeBtn{position:absolute;top:12px;right:16px;border:0;background:#eee;border-radius:50%;width:34px;height:34px;cursor:pointer;font-weight:bold}
#popupContent{padding:12px 16px 20px}
.popup-title{font-size:20px;font-weight:800;margin:6px 0 4px}
.popup-sub{color:#6b7280;margin:0 0 8px}
.popup-price{margin:6px 0 10px}
.popup-tags{display:flex;flex-wrap:wrap;gap:6px;margin:6px 0 12px}
.popup-tags .tag{background:#f3f4f6}
.gallery{display:grid;grid-template-columns:1fr;gap:10px}
.gallery img{width:100%;border-radius:10px;object-fit:contain}
/* ë§í’ì„  í˜ì´ë“œì¸ íš¨ê³¼ */
.bubble.ai {
  opacity: 0;
  animation: fadeIn 0.45s ease forwards;
}

@keyframes fadeIn {
  from {
    opacity: 0;
    transform: translateY(8px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}
/* ---------- ë§í’ì„  & ì¹´ë“œ ë“±ì¥ ì• ë‹ˆë©”ì´ì…˜ (ì•„ì£¼ ì°¨ë¶„í•œ ë²„ì „) ---------- */

/* AI / ME ë§í’ì„  */
.bubble {
  opacity: 0;
  transform: translateY(14px);
  animation: fadeSlideIn 1.2s cubic-bezier(0.19, 0.15, 0.12, 1) forwards;
}

@keyframes fadeSlideIn {
  from {
    opacity: 0;
    transform: translateY(14px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

/* ìƒí’ˆ ì¹´ë“œ ê³„ë‹¨ì‹ ë“±ì¥ */
.deck .card {
  opacity: 0;
  transform: translateY(20px);
  animation: cardFadeIn 1.4s cubic-bezier(0.2, 0.15, 0.1, 1) forwards;
}

@keyframes cardFadeIn {
  from {
    opacity: 0;
    transform: translateY(20px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

/* ê³„ë‹¨ì‹ ì§€ì—° íš¨ê³¼ (ì•„ì£¼ ëŠê¸‹í•˜ê²Œ) */
.deck .card:nth-child(1) { animation-delay: 0.15s; }
.deck .card:nth-child(2) { animation-delay: 0.3s; }
.deck .card:nth-child(3) { animation-delay: 0.45s; }
.deck .card:nth-child(4) { animation-delay: 0.6s; }
.deck .card:nth-child(5) { animation-delay: 0.75s; }
.deck .card:nth-child(6) { animation-delay: 0.9s; }
.deck .card:nth-child(7) { animation-delay: 1.05s; }
.deck .card:nth-child(8) { animation-delay: 1.2s; }
.deck .card:nth-child(9) { animation-delay: 1.35s; }
.deck .card:nth-child(10){ animation-delay: 1.5s; }
.deck .card:nth-child(11) { animation-delay: 1.65s; }
.deck .card:nth-child(12) { animation-delay: 1.8s; }
.deck .card:nth-child(13) { animation-delay: 1.95s; }
.deck .card:nth-child(14) { animation-delay: 2.1s; }
.deck .card:nth-child(15) { animation-delay: 2.25s; }

/* ---------- ì‚¬ìš©ì(ME) ë§í’ì„  ì˜¤ë¥¸ìª½ ì •ë ¬ ---------- */
.row:has(.me) {
  justify-content: flex-end;
}

.row:has(.me) .avatar {
  order: 2; /* ë§í’ì„  ë’¤ë¡œ ì´ë™ */
  margin-left: 6px;
  margin-right: 0;
  background: #bae6fd;
  color: #0369a1;
}

.row:has(.me) .bubble.me {
  background: #e0f2fe;
  border-top-left-radius: 14px;
  border-top-right-radius: 6px;
  text-align: right;
}
/* ---------- ì´ë²¤íŠ¸ ë¬¸êµ¬ìš© ê°•ì¡° ìŠ¤íƒ€ì¼ ---------- */
/* ---------- ì´ë²¤íŠ¸ ë¬¸êµ¬ìš© ê°•ì¡° ìŠ¤íƒ€ì¼ (í¬ê¸° í™•ì¥ ë²„ì „) ---------- */
/* ---------- ì´ë²¤íŠ¸ ë¬¸êµ¬ìš© ê°•ì¡° ìŠ¤íƒ€ì¼ (ê°€ë¡œ í™•ì¥ + ì¤„ë°”ê¿ˆ ë°©ì§€ ë²„ì „) ---------- */
.event-msg {
  background: linear-gradient(135deg, #fef3c7, #fbcfe8, #bfdbfe);
  padding: 18px 26px;
  border-radius: 14px;
  display: inline-block;

  /* âœ… ì¶”ê°€ëœ ë¶€ë¶„ */
  text-align: center;      /* ë§í’ì„  ì•ˆ ë¬¸êµ¬ ì¤‘ì•™ ì •ë ¬ */
  white-space: normal;     /* ìë™ ì¤„ë°”ê¿ˆ í—ˆìš© */
  word-break: keep-all;    /* ë‹¨ì–´ ë‹¨ìœ„ë¡œ ì¤„ë°”ê¿ˆ (í•œêµ­ì–´ ê¹¨ì§ ë°©ì§€) */

  color: #1f2937;
  font-weight: 600;
  font-size: 17px;
  line-height: 1.7;
  box-shadow: 0 4px 16px rgba(0,0,0,0.08);
  animation: popIn 0.8s ease forwards;
  width: 100%;             /* ë§í’ì„  ê°€ë¡œí­ì„ AI ë²„ë¸” ì•ˆìª½ìœ¼ë¡œ ê½‰ ì±„ì›€ */
  max-width: 500px;        /* ë„ˆë¬´ ë„“ì–´ì§€ì§€ ì•Šê²Œ ì œí•œ */
  margin: 0 auto;          /* ê°€ìš´ë° ì •ë ¬ */
}
.event-msg strong {
  color: #dc2626;
  font-weight: 800;
  font-size: 18px;
}

@keyframes popIn {
  from { transform: scale(0.94); opacity: 0; }
  to { transform: scale(1); opacity: 1; }
}
/* ---------- ì´ë²¤íŠ¸ ì „ìš© íŒì—… í¬ê¸° ì¡°ì • ---------- */
.event-popup {
  position: relative;
  background: transparent;
  display: flex;
  flex-direction: column;
  align-items: center;
  padding: 30px 20px;
  animation: fadePop 0.45s ease;
}

.event-popup .event-msg {
  max-width: 320px;
  text-align: center;
  font-size: 15px;
}

.closeBtn.small {
  position: absolute;
  top: 0;
  right: 0;
  background: #f3f4f6;
  width: 28px;
  height: 28px;
  font-size: 14px;
  color: #555;
}

/* íŒì—… ë“±ì¥ ë¶€ë“œëŸ½ê²Œ */
@keyframes fadePop {
  from { opacity: 0; transform: translateY(10px) scale(0.96); }
  to { opacity: 1; transform: translateY(0) scale(1); }
}
/* ---------- ì´ë²¤íŠ¸ ì•ˆë‚´ ì „ìš© íŒì—… í¬ê¸° ì¡°ì • ---------- */
/* ---------- ì´ë²¤íŠ¸ ì•ˆë‚´ ì „ìš© íŒì—… (ë§í’ì„  í¬ê¸° ì¼ì²´ê° ì¡°ì •) ---------- */
#popupBox.event-mode {
  max-width: 440px; /* âœ… ê¸°ì¡´ë³´ë‹¤ ë„“ê²Œ */
  width: auto;
  padding: 28px 24px; /* âœ… ì—¬ìœ ë¡œìš´ ë‚´ë¶€ ì—¬ë°± */
  border-radius: 18px;
  box-shadow: 0 8px 30px rgba(0,0,0,0.1);
  display: flex;
  justify-content: center;
  align-items: center;
  animation: popupFloat 0.45s ease forwards;
}

#popupBox.event-mode #popupContent {
  padding: 0; /* âœ… ì¤‘ë³µ ì—¬ë°± ì œê±° */
  display: flex;
  justify-content: center;
  align-items: center;
}

#popupBox.event-mode .event-msg {
  max-width: 100%; /* âœ… íŒì—… ë‚´ë¶€ì—ì„œ ìì—°ìŠ¤ëŸ½ê²Œ ê½‰ ì°¨ê²Œ */
  text-align: center;
}

#popupBox.event-mode .closeBtn {
  top: 10px;
  right: 12px;
  width: 28px;
  height: 28px;
  font-size: 14px;
  background: #f3f4f6;
  color: #555;
}

/* ë¶€ë“œëŸ¬ìš´ ë“±ì¥ íš¨ê³¼ */
@keyframes popupFloat {
  from { opacity: 0; transform: translateY(10px) scale(0.96); }
  to { opacity: 1; transform: translateY(0) scale(1); }
}
/* ---------- ì¡°ê±´ ë‹¬ì„± ì‹œ í• ì¸ (ì¡°ê±´ë§Œ ë°°ê²½, ë‚˜ë¨¸ì§€ëŠ” í‰ë¬¸) ---------- */
.sale-badge {
  display: inline-flex;
  align-items: center;
  gap: 2px;
  font-size: 13px;
  font-weight: 600;
  color: #78350f;
  background: none; /* âœ… ì „ì²´ ë°•ìŠ¤ ë°°ê²½ ì œê±° */
}

.cond-tag {
  background: #fde68a;
  border-radius: 6px;
  padding: 2px 8px;
  font-weight: 700;
  color: #78350f;
  cursor: pointer;
  transition: background 0.25s ease, transform 0.15s ease;
  box-shadow: inset 0 1px 2px rgba(0,0,0,0.05);
}

.cond-tag:hover {
  background: #fcd34d;
  transform: scale(1.05);
}

.sale-text {
  color: #78350f;
  opacity: 0.9;
  background: none;
}
/* ì˜¤ë¥¸ìª½ ì •ë ¬ëœ ME ë§í’ì„  */
.row:has(.me) {
  justify-content: flex-end;
}

.row:has(.me) .avatar {
  order: 2;
  margin-left: 6px;
  background: #bae6fd;
  color: #0369a1;
}

.row:has(.me) .bubble.me {
  background: #e0f2fe;
  border-top-left-radius: 14px;
  border-top-right-radius: 6px;
  text-align: right;
}

/* ì„¸ë¡œí˜• ì„ íƒì§€ (ì˜¤ë¥¸ìª½ ì •ë ¬í˜•) */
.choices.vertical.right {
  display: flex;
  flex-direction: column;
  align-items: flex-end; /* âœ… ì˜¤ë¥¸ìª½ ì •ë ¬ í•µì‹¬ */
  gap: 10px;
  margin-top: 6px;
}

.pill.full {
  width: auto; /* ë²„íŠ¼ í¬ê¸° ë‚´ìš©ì— ë§ê²Œ */
  text-align: center;
  font-size: 14px;
  padding: 10px 20px;
}
/* ---------- ê´€ë¦¬ì ëª¨ë“œ ---------- */
#adminPanel {
  position: fixed;
  top: 60px;
  right: 20px;
  width: 320px;
  max-height: 70vh;
  overflow-y: auto;
  background: #fff;
  border: 1px solid #e5e7eb;
  border-radius: 12px;
  box-shadow: 0 8px 30px rgba(0,0,0,0.15);
  padding: 14px 16px;
  z-index: 500;
  display: none;
}
#adminPanel h3 {
  margin: 0 0 8px;
  font-size: 16px;
}
#adminList {
  display: flex;
  flex-direction: column;
  gap: 6px;
}
.admin-item {
  display: flex;
  justify-content: space-between;
  align-items: center;
  font-size: 13px;
  padding: 4px 0;
}
#adminToggle {
  position: fixed;
  bottom: 20px;
  right: 20px;
  background: transparent; /* âœ… íŒŒë€ ë°°ê²½ ì œê±° */
  color: #475569; /* ì§„íšŒìƒ‰ ì•„ì´ì½˜ */
  border: none;
  border-radius: 50%;
  width: 48px;
  height: 48px;
  font-size: 24px; /* ì•„ì´ì½˜ í¬ê¸° ì‚´ì§ í‚¤ì›€ */
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  transition: transform 0.2s ease, color 0.2s ease;
}
#adminToggle:hover {
  color: #1e40af; /* hover ì‹œ íŒŒë€ìƒ‰ìœ¼ë¡œ ë³€í™” */
  transform: rotate(30deg);
}
/* ---------- í’ˆì ˆ í‘œì‹œ ---------- */
.soldout-overlay {
  position: absolute;
  inset: 0;
  background: rgba(0,0,0,0.5);
  color: #fff;
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: 800;
  font-size: 18px;
  border-radius: 8px;
  backdrop-filter: blur(2px);
}
.top-banner img {
  display: block;
  width: 100%;
  max-width: 950px;  /* ëŒ€í™”ì°½(panel)ê³¼ ë™ì¼í•œ í­ */
  height: auto;
  margin: 0 auto;     /* ì¤‘ì•™ ì •ë ¬ */
  border-radius: 10px;
  box-shadow: 0 4px 20px rgba(0,0,0,0.05);
}
/* ====== ë†’ì´ ë§ì¶¤ í•µì‹¬ ====== */
main {
  display: grid;
  grid-template-columns: 1fr 180px;
  gap: 16px;
  align-items: start; /* âœ… ë‘ ë°•ìŠ¤ì˜ ìƒë‹¨ ê¸°ì¤€ ë§ì¶”ê¸° */
}

/* ì™¼ìª½ ëŒ€í™”ì°½ íŒ¨ë„ */
.panel {
  display: flex;
  flex-direction: column;
  height: 74.5vh;             /* âœ… railê³¼ ë™ì¼í•œ ë†’ì´ */
  background: var(--panel);
  border-radius: 16px;
  box-shadow: var(--shadow);
  overflow: hidden;
}

/* ëŒ€í™” ë‚´ìš© ì˜ì—­ */
.chat {
  flex: 1;
  overflow-y: auto;
  padding: 18px;
  scroll-behavior: smooth;
}

/* ì˜¤ë¥¸ìª½ ì„ íƒì§€ rail */
.rail {
  display: flex;
  flex-direction: column;
  gap: 16px;
  height: 78vh;             /* âœ… panelê³¼ ë™ì¼ */
  overflow-y: auto;
  scrollbar-width: thin;
  scrollbar-color: #d1d5db transparent;
}
/* ---------- ëŒ€ê¸° í™”ë©´ ---------- */
#standbyScreen {
  position: fixed;
  inset: 0;
  background: #000;
  display: flex;
  justify-content: center;
  align-items: center;
  overflow: hidden;
  z-index: 9999; /* ìµœìƒë‹¨ */
  flex-direction: column;
}

.slideshow {
  position: absolute;
  inset: 0;
  width: 100%;
  height: 100%;
}

.slideshow img {
  position: absolute;
  width: 100%;
  height: 100%;
  object-fit: cover;
  opacity: 0;
  transition: opacity 1.2s ease-in-out;
}

.slideshow img.active {
  opacity: 1;
}

/* ---------- ëŒ€ê¸° í™”ë©´ ë²„íŠ¼ (ë”°ëœ»í•œ ì„œì í†¤) ---------- */
#standbyScreen {
  background: radial-gradient(circle at center, #111 0%, #000 80%);
}

/* ---------- ëŒ€ê¸° í™”ë©´ ë²„íŠ¼ (ë”°ëœ»í•œ ì„œì í†¤, ë¹› ìŠ¤ì¹¨ ì œê±° ë²„ì „) ---------- */
/* ë²„íŠ¼ ê¸°ë³¸ ìŠ¤íƒ€ì¼ (ë”°ëœ»í•œ ì„œì í†¤ ìœ ì§€) */
#enterButton {
  position: relative;
  z-index: 10;
  padding: 38px 72px;
  border: none;
  border-radius: 36px;
  background: linear-gradient(135deg, #f8e9d2 0%, #d4a373 100%);
  color: #3f2e12;
  cursor: pointer;
  box-shadow: 0 10px 28px rgba(0, 0, 0, 0.35);
  transition: all 0.45s cubic-bezier(0.16, 1, 0.3, 1);
  font-family: "Pretendard Variable", "Pretendard", sans-serif;
  letter-spacing: -0.3px;
  text-align: center;
  animation: floatIn 1.4s ease-out forwards;
}

/* ë‚´ë¶€ ë¼ì¸ ì •ë ¬ */
.btn-lines {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 6px;
}

/* ì²« ì¤„ (ì„œì ëª…) */
#enterButton .line1 {
  font-size: 27px;
  font-weight: 800;
}

/* ë‘˜ì§¸ ì¤„ (ë¬¸êµ¬ + í™”ì‚´í‘œ) */
#enterButton .line2 {
  font-size: 20px;
  font-weight: 600;
  display: inline-flex;
  align-items: center;
  gap: 6px;
}

/* í™”ì‚´í‘œ */
#enterButton .arrow {
  display: inline-block;
  transition: transform 0.25s ease;
}

/* hover ì‹œ ë²„íŠ¼ ì „ì²´ ë°˜ì‘ */
#enterButton:hover {
  transform: translateY(-5px) scale(1.05);
  background: linear-gradient(135deg, #f9e3b1 0%, #d9a86a 100%);
  box-shadow: 0 14px 36px rgba(0, 0, 0, 0.5);
}

/* hover ì‹œ í™”ì‚´í‘œ ì‚´ì§ ë°€ë¦¼ íš¨ê³¼ */
#enterButton:hover .arrow {
  transform: translateX(5px);
}

/* ë“±ì¥ ì‹œ ë¶€ë“œëŸ½ê²Œ ë– ì˜¤ë¦„ */
@keyframes floatIn {
  0% { opacity: 0; transform: translateY(40px) scale(0.95); }
  70% { opacity: 1; transform: translateY(-3px) scale(1.03); }
  100% { transform: translateY(0) scale(1); }
}

/* ëª¨ë°”ì¼ ëŒ€ì‘ */
@media (max-width: 480px) {
  #enterButton {
    padding: 28px 50px;
  }
  #enterButton .line1 {
    font-size: 20px;
  }
  #enterButton .line2 {
    font-size: 16px;
  }
}

</style>
</head>
<body>
<!-- âœ… ëŒ€ê¸° í™”ë©´ -->
<div id="standbyScreen">
  <div class="slideshow">
    <img src="images/Standby1.jpg" class="active" alt="ìŠ¬ë¼ì´ë“œ 1">
    <img src="images/Standby2.jpg" alt="ìŠ¬ë¼ì´ë“œ 2">
    <img src="images/Standby3.jpg" alt="ìŠ¬ë¼ì´ë“œ 3">
    <img src="images/Standby4.jpg" alt="ìŠ¬ë¼ì´ë“œ 4">
    <img src="images/Standby5.jpg" alt="ìŠ¬ë¼ì´ë“œ 5">
    <img src="images/Standby6.jpg" alt="ìŠ¬ë¼ì´ë“œ 6">
    <img src="images/Standby7.jpg" alt="ìŠ¬ë¼ì´ë“œ 7">
    <img src="images/Standby8.jpg" alt="ìŠ¬ë¼ì´ë“œ 8">
    <img src="images/Standby9.jpg" alt="ìŠ¬ë¼ì´ë“œ 9">
    <img src="images/Standby10.jpg" alt="ìŠ¬ë¼ì´ë“œ 10">
    <img src="images/Standby11.jpg" alt="ìŠ¬ë¼ì´ë“œ 11">
    <img src="images/Standby12.jpg" alt="ìŠ¬ë¼ì´ë“œ 12">
    <img src="images/Standby13.jpg" alt="ìŠ¬ë¼ì´ë“œ 13">
  </div>

  <button id="enterButton">
  <div class="btn-lines">
    <span class="line1">ì•Œë¼ë”˜ ì¤‘ê³ ì„œì </span>
    <span class="line2">2026 ë‹¬ë ¥Â·ë‹¤ì´ì–´ë¦¬ ì‚´í´ë³´ê¸° <span class="arrow">âœ</span></span>
  </div>
</button>


</div>
<header class="top-banner">
  <img src="images/top_banner.jpg" alt="2026 ë‹¬ë ¥Â·ë‹¤ì´ì–´ë¦¬ ì¶”ì²œ" />
</header>

<main class="wrap">
  <!-- ê°€ìš´ë° ëŒ€í™”ì°½ -->
  <section class="panel">
    <div id="chat" class="chat" aria-live="polite"></div>
    <div class="composer"><div id="quick" class="choices"></div></div>
    <div class="helper"><strong>ì´ë²¤íŠ¸</strong> Â· ë‹¬ë ¥Â·ë‹¤ì´ì–´ë¦¬ ì œì™¸ 1ë§Œì› ì´ìƒ êµ¬ë§¤ ì‹œ â†’ <strong>20% í• ì¸</strong></div>
  </section>

  <!-- ì˜¤ë¥¸ìª½ ì„ íƒì§€ rail -->
  <aside class="rail">
    <div class="box">
      <h3>ë¹ ë¥¸ ì‹œì‘</h3>
      <div class="choices" id="starts"></div>
    </div>
    <div class="box">
      <h3>ëŒ€í™” ì„ íƒì§€</h3>
      <div class="choices" id="filters"></div>
    </div>
  </aside>
</main>
<!-- Popup -->
<div id="popupOverlay">
  <div id="popupBox">
    <button class="closeBtn" onclick="closePopup()">âœ•</button>
    <div id="popupContent"></div>
  </div>
</div>

<!-- ê´€ë¦¬ì ëª¨ë“œ íŒ¨ë„ -->
<div id="adminPanel">
  <h3>ê´€ë¦¬ì ëª¨ë“œ ğŸ› ï¸</h3>
  <div id="adminList"></div>

  <button onclick="saveSoldOut()" style="margin-top:10px;padding:6px 12px;font-size:13px;border-radius:8px;border:1px solid #ccc;cursor:pointer;">
    í’ˆì ˆ ì €ì¥í•˜ê¸°
  </button>

  <hr style="margin:12px 0;border:none;border-top:1px solid #eee;">

  <button onclick="renderClickStats()" style="padding:6px 12px;font-size:13px;border-radius:8px;border:1px solid #ccc;cursor:pointer;">
    ğŸ” í´ë¦­ í†µê³„ ë³´ê¸°
  </button>

  <button onclick="resetClickStats()" style="margin-top:6px;padding:6px 12px;font-size:13px;border-radius:8px;border:1px solid #ccc;cursor:pointer;color:#b91c1c;">
    â™»ï¸ í´ë¦­ í†µê³„ ì´ˆê¸°í™”
  </button>
</div>


<!-- ê´€ë¦¬ì ëª¨ë“œ í† ê¸€ ë²„íŠ¼ (âš™ï¸ ì•„ì´ì½˜ìœ¼ë¡œ ë³€ê²½) -->
<button id="adminToggle" onclick="toggleAdmin()" aria-label="ê´€ë¦¬ì ëª¨ë“œ">
  âš™ï¸
</button>


<script>
/* ---------- Catalog ---------- */
const CATALOG = [
  { eng:"cal_peanuts_desk", name:"2026 íƒìƒ ë‹¬ë ¥ í”¼ë„ˆì¸ ", kind:"calendar", subtype:"desk", price:5900, sale:4700, discount:20, tags:["í”¼ë„ˆì¸ ","íƒìƒ","ì¼ëŸ¬ìŠ¤íŠ¸","ê·€ì—¬ì›€"], img:"images/thumb_cal_peanuts_desk.jpg", gallery:["images/detail_cal_peanuts_desk_1.jpg","images/detail_cal_peanuts_desk_2.jpg","images/detail_cal_peanuts_desk_3.jpg","images/detail_cal_peanuts_desk_4.jpg","images/detail_cal_peanuts_desk_5.jpg"], blurb:"ê·€ì—¬ìš´ ìŠ¤ëˆ„í”¼ì™€ í•¨ê»˜ ì‹œì‘í•˜ëŠ” ì¼ ë…„." },
  { eng:"cal_cat_korean_desk", name:"2026 íƒìƒ ë‹¬ë ¥ ëƒ¥ëƒ¥ì±…ë°© í•œêµ­í™”", kind:"calendar", subtype:"desk", price:5900, sale:4700, discount:20, tags:["ê³ ì–‘ì´","í•œêµ­í™”","íƒìƒ","ê°ì„±"], img:"images/thumb_cal_cat_korean_desk.jpg", gallery:["images/detail_cal_cat_korean_desk_1.jpg","images/detail_cal_cat_korean_desk_2.jpg","images/detail_cal_cat_korean_desk_3.jpg","images/detail_cal_cat_korean_desk_4.jpg","images/detail_cal_cat_korean_desk_5.jpg"], blurb:"ë‹´ë‹´í•œ í•œêµ­í™” í„°ì¹˜, ì¡°ìš©í•œ ìœ„ë¡œ." },
  { eng:"cal_peanuts_tear", name:"2026 í”¼ë„ˆì¸  ì¹´íˆ° ì¼ë ¥", kind:"calendar", subtype:"tear", price:13800, sale:11000, discount:20, tags:["í”¼ë„ˆì¸ ","ì¼ë ¥","í•œì¥ì”©","ì¹´íˆ°"], img:"images/thumb_cal_peanuts_tear.jpg", gallery:["images/detail_cal_peanuts_tear_1.jpg","images/detail_cal_peanuts_tear_2.jpg","images/detail_cal_peanuts_tear_3.jpg","images/detail_cal_peanuts_tear_4.jpg","images/detail_cal_peanuts_tear_5.jpg"], blurb:"í•˜ë£¨ í•œ ì¥, ì†Œì†Œí•œ ì¹´íˆ° ìŠµê´€." },
  { eng:"cal_vangogh_wall", name:"2026 ë²½ê±¸ì´ ë‹¬ë ¥ ê³ í", kind:"calendar", subtype:"wall", price:9500, sale:7600, discount:20, tags:["ëª…í™”","ê³ í","ë²½ê±¸ì´","ê°ì„±"], img:"images/thumb_cal_vangogh_wall.jpg", gallery:["images/detail_cal_vangogh_wall_1.jpg","images/detail_cal_vangogh_wall_2.jpg","images/detail_cal_vangogh_wall_3.jpg","images/detail_cal_vangogh_wall_4.jpg","images/detail_cal_vangogh_wall_5.jpg"], blurb:"ê³„ì ˆ ë”°ë¼ ë§Œë‚˜ëŠ” ê³ íì˜ ë¹›." },
  { eng:"cal_masterpiece_wall", name:"2026 ë²½ê±¸ì´ ë‹¬ë ¥ ëª…í™”", kind:"calendar", subtype:"wall", price:9500, sale:7600, discount:20, tags:["ëª…í™”","ë²½ê±¸ì´","í´ë˜ì‹"], img:"images/thumb_cal_masterpiece_wall.jpg", gallery:["images/detail_cal_masterpiece_wall_1.jpg","images/detail_cal_masterpiece_wall_2.jpg","images/detail_cal_masterpiece_wall_3.jpg","images/detail_cal_masterpiece_wall_4.jpg","images/detail_cal_masterpiece_wall_5.jpg"], blurb:"ê³ ì „ ëª…í™”, ì§‘ì•ˆì˜ ì‘ì€ ê°¤ëŸ¬ë¦¬." },

  { eng:"dia_weekly_cat", name:"2026 ìœ„í´ë¦¬ ë‹¤ì´ì–´ë¦¬ ìê°œì¥ ê³ ì–‘ì´", kind:"diary", subtype:"weekly", price:12800, sale:10200, discount:20, tags:["ìœ„í´ë¦¬","ê³ ì–‘ì´","ìê°œì¥","ê°ì„±"], img:"images/thumb_dia_weekly_cat.jpg", gallery:["images/detail_dia_weekly_cat_1.jpg","images/detail_dia_weekly_cat_2.gif","images/detail_dia_weekly_cat_3.jpg","images/detail_dia_weekly_cat_4.jpg","images/detail_dia_weekly_cat_5.jpg","images/detail_dia_weekly_cat_6.jpg","images/detail_dia_weekly_cat_7.jpg","images/detail_dia_weekly_cat_8.jpg","images/detail_dia_weekly_cat_9.jpg","images/detail_dia_weekly_cat_10.jpg","images/detail_dia_weekly_cat_11.jpg"], blurb:"ìê°œì¥ íŒ¨í„´, ê³ ì–‘ì´ì™€ í•¨ê»˜í•˜ëŠ” ì£¼ê°„ ê¸°ë¡." },
  { eng:"dia_weekly_nasa", name:"2026 ìœ„í´ë¦¬ ë‹¤ì´ì–´ë¦¬ NASA", kind:"diary", subtype:"weekly", price:12800, sale:10200, discount:20, tags:["ìœ„í´ë¦¬","NASA","ìš°ì£¼","ëª¨í‹°ë¸Œ"], img:"images/thumb_dia_weekly_nasa.jpg", gallery:["images/detail_dia_weekly_nasa_1.jpg","images/detail_dia_weekly_nasa_2.gif","images/detail_dia_weekly_nasa_3.jpg","images/detail_dia_weekly_nasa_4.gif","images/detail_dia_weekly_nasa_5.jpg","images/detail_dia_weekly_nasa_6.jpg","images/detail_dia_weekly_nasa_7.jpg","images/detail_dia_weekly_nasa_8.jpg","images/detail_dia_weekly_nasa_9.jpg","images/detail_dia_weekly_nasa_10.jpg","images/detail_dia_weekly_nasa_11.jpg","images/detail_dia_weekly_nasa_12.jpg"], blurb:"ìš°ì£¼ ì·¨í–¥ì—ê²Œ ë”±, ê¹”ë”í•œ ì£¼ê°„ í”Œë˜ë„ˆ." },
  { eng:"dia_weekly_olive", name:"2026 ìœ„í´ë¦¬ ë‹¤ì´ì–´ë¦¬ ì˜¬ë¦¬ë¸Œ, ê¹€ì´ë‘", kind:"diary", subtype:"weekly", price:12800, sale:10200, discount:20, tags:["ìœ„í´ë¦¬","ì˜¬ë¦¬ë¸Œ","ì¼ëŸ¬ìŠ¤íŠ¸","ê°ì„±"], img:"images/thumb_dia_weekly_olive.jpg", gallery:["images/detail_dia_weekly_olive_1.jpg","images/detail_dia_weekly_olive_2.gif","images/detail_dia_weekly_olive_3.jpg","images/detail_dia_weekly_olive_4.jpg","images/detail_dia_weekly_olive_5.jpg","images/detail_dia_weekly_olive_6.jpg","images/detail_dia_weekly_olive_7.jpg","images/detail_dia_weekly_olive_8.jpg","images/detail_dia_weekly_olive_9.jpg","images/detail_dia_weekly_olive_10.jpg","images/detail_dia_weekly_olive_11.jpg"], blurb:"ì˜¬ë¦¬ë¸Œë¹› í•˜ë£¨ë“¤ì„ ì£¼ê°„ìœ¼ë¡œ ì •ë¦¬." },
  { eng:"dia_weekly_ligok", name:"2026 ìœ„í´ë¦¬ ë‹¤ì´ì–´ë¦¬ ë¦¬ê³¡", kind:"diary", subtype:"weekly", price:12800, sale:10200, discount:20, tags:["ìœ„í´ë¦¬","ë¦¬ê³¡","ì¼ëŸ¬ìŠ¤íŠ¸","ì°¨ë¶„"], img:"images/thumb_dia_weekly_ligok.jpg", gallery:["images/detail_dia_weekly_ligok_1.jpg","images/detail_dia_weekly_ligok_2.gif","images/detail_dia_weekly_ligok_3.jpg","images/detail_dia_weekly_ligok_4.jpg","images/detail_dia_weekly_ligok_5.jpg","images/detail_dia_weekly_ligok_6.jpg","images/detail_dia_weekly_ligok_7.jpg","images/detail_dia_weekly_ligok_8.jpg","images/detail_dia_weekly_ligok_9.jpg","images/detail_dia_weekly_ligok_10.jpg","images/detail_dia_weekly_ligok_11.jpg"], blurb:"ë¦¬ê³¡ì˜ ë‹´ë°±í•¨ìœ¼ë¡œ ê³„íšì„ ë‹¨ì •íˆ." },

  { eng:"dia_daily_peanuts_red", name:"2026 ë°ì¼ë¦¬ ë‹¤ì´ì–´ë¦¬ í”¼ë„ˆì¸  ë ˆë“œ", kind:"diary", subtype:"daily", price:12800, sale:10200, discount:20, tags:["ë°ì¼ë¦¬","í”¼ë„ˆì¸ ","ë ˆë“œ","ì¼ëŸ¬ìŠ¤íŠ¸"], img:"images/thumb_dia_daily_peanuts_red.jpg", gallery:["images/detail_dia_daily_peanuts_red_1.jpg","images/detail_dia_daily_peanuts_red_2.jpg","images/detail_dia_daily_peanuts_red_3.jpg","images/detail_dia_daily_peanuts_red_4.jpg","images/detail_dia_daily_peanuts_red_5.jpg"], blurb:"ë§¤ì¼ ìŠ¤ëˆ„í”¼ì™€ REDë¡œ ì±„ìš°ëŠ” ë™ê¸°ë¶€ì—¬." },
  { eng:"dia_daily_peanuts_green", name:"2026 ë°ì¼ë¦¬ ë‹¤ì´ì–´ë¦¬ í”¼ë„ˆì¸  ê·¸ë¦°", kind:"diary", subtype:"daily", price:12800, sale:10200, discount:20, tags:["ë°ì¼ë¦¬","í”¼ë„ˆì¸ ","ê·¸ë¦°","ì¼ëŸ¬ìŠ¤íŠ¸"], img:"images/thumb_dia_daily_peanuts_green.jpg", gallery:["images/detail_dia_daily_peanuts_green_1.jpg","images/detail_dia_daily_peanuts_green_2.jpg","images/detail_dia_daily_peanuts_green_3.jpg","images/detail_dia_daily_peanuts_green_4.jpg","images/detail_dia_daily_peanuts_green_5.jpg"], blurb:"GREEN ì—ë””ì…˜, ë¶€ë“œëŸ¬ìš´ í•˜ë£¨ ë£¨í‹´." },
  { eng:"dia_daily_cat_moon", name:"2026 ë°ì¼ë¦¬ ë‹¤ì´ì–´ë¦¬ ë‹¬ë°¤ì˜ ê³ ì–‘ì´", kind:"diary", subtype:"daily", price:12800, sale:10200, discount:20, tags:["ë°ì¼ë¦¬","ê³ ì–‘ì´","ê°ì„±","ë°¤"], img:"images/thumb_dia_daily_cat_moon.jpg", gallery:["images/detail_dia_daily_cat_moon_1.jpg","images/detail_dia_daily_cat_moon_2.gif","images/detail_dia_daily_cat_moon_3.jpg","images/detail_dia_daily_cat_moon_4.jpg","images/detail_dia_daily_cat_moon_5.jpg","images/detail_dia_daily_cat_moon_6.jpg","images/detail_dia_daily_cat_moon_7.jpg","images/detail_dia_daily_cat_moon_8.jpg"], blurb:"ë‹¬ë¹› ì•„ë˜ ê³ ì–‘ì´, í•˜ë£¨ë¥¼ ì²œì²œíˆ." },
  { eng:"dia_daily_nasa", name:"2026 ë°ì¼ë¦¬ ë‹¤ì´ì–´ë¦¬ NASA", kind:"diary", subtype:"daily", price:12800, sale:10200, discount:20, tags:["ë°ì¼ë¦¬","NASA","ìš°ì£¼","ëª¨í‹°ë¸Œ"], img:"images/thumb_dia_daily_nasa.jpg", gallery:["images/detail_dia_daily_nasa_1.jpg","images/detail_dia_daily_nasa_2.gif","images/detail_dia_daily_nasa_3.jpg","images/detail_dia_daily_nasa_4.gif","images/detail_dia_daily_nasa_5.jpg","images/detail_dia_daily_nasa_6.jpg","images/detail_dia_daily_nasa_7.jpg","images/detail_dia_daily_nasa_8.jpg","images/detail_dia_daily_nasa_9.jpg","images/detail_dia_daily_nasa_10.jpg","images/detail_dia_daily_nasa_11.jpg","images/detail_dia_daily_nasa_12.jpg"], blurb:"ì˜¤ëŠ˜ì˜ í•œ ê±¸ìŒ, ìš°ì£¼ ì·¨í–¥ê³¼ í•¨ê»˜." },

  { eng:"dia_mini_alice", name:"2026 ë¯¸ë‹ˆ ë‹¤ì´ì–´ë¦¬ ì•¨ë¦¬ìŠ¤", kind:"diary", subtype:"mini", price:12000, sale:9600, discount:20, tags:["ë¯¸ë‹ˆ","ì•¨ë¦¬ìŠ¤","ì¼ëŸ¬ìŠ¤íŠ¸","í¬ì¼“"], img:"images/thumb_dia_mini_alice.jpg", gallery:["images/detail_dia_mini_alice_1.jpg","images/detail_dia_mini_alice_2.jpg","images/detail_dia_mini_alice_3.jpg","images/detail_dia_mini_alice_4.jpg","images/detail_dia_mini_alice_5.jpg","images/detail_dia_mini_alice_6.jpg","images/detail_dia_mini_alice_7.jpg","images/detail_dia_mini_alice_8.jpg"], blurb:"ê°€ë³ê²Œ ë“¤ê³  ë‹¤ë‹ˆëŠ” í¬ì¼“ ì €ë„." },
  { eng:"dia_mini_ligok", name:"2026 ë¯¸ë‹ˆ ë‹¤ì´ì–´ë¦¬ ë¦¬ê³¡", kind:"diary", subtype:"mini", price:12000, sale:9600, discount:20, tags:["ë¯¸ë‹ˆ","ë¦¬ê³¡","ì°¨ë¶„","í¬ì¼“"], img:"images/thumb_dia_mini_ligok.jpg", gallery:["images/detail_dia_mini_ligok_1.jpg","images/detail_dia_mini_ligok_2.jpg","images/detail_dia_mini_ligok_3.jpg","images/detail_dia_mini_ligok_4.jpg","images/detail_dia_mini_ligok_5.jpg","images/detail_dia_mini_ligok_6.jpg","images/detail_dia_mini_ligok_7.jpg","images/detail_dia_mini_ligok_8.jpg"], blurb:"ì‘ì§€ë§Œ ë‹¨ì •í•œ, ë¦¬ê³¡ ë¯¸ë‹ˆ." }
];

/* ---------- Presets ---------- */
const STARTS = [
  { t:"ë‹¬ë ¥ ì°¾ê¸°", q:"ë‹¬ë ¥ì´ í•„ìš”í•´ìš”" },
  { t:"ë‹¤ì´ì–´ë¦¬ ì°¾ê¸°", q:"ë‹¤ì´ì–´ë¦¬ ë³´ê³ ì‹¶ì–´ìš”" }
];
const FILTERS = ["íƒìƒ","ë²½ê±¸ì´","ì¼ë ¥","ìœ„í´ë¦¬","ë°ì¼ë¦¬","ë¯¸ë‹ˆ","í”¼ë„ˆì¸ ","ê³ ì–‘ì´","ëª…í™”","NASA","í•œêµ­í™”","ë¦¬ê³¡","ì•¨ë¦¬ìŠ¤","ì˜¬ë¦¬ë¸Œ"];

/* ---------- Chat primitives ---------- */
const chat = document.getElementById('chat');
const quick = document.getElementById('quick');

function row(isAI){
  const r=document.createElement('div'); r.className='row';
  const a=document.createElement('div'); a.className='avatar'; a.textContent=isAI? 'AI':'ME';
  const b=document.createElement('div'); b.className='bubble ' + (isAI? 'ai':'me');
  r.append(a,b); chat.append(r); return b;
}
function sayAI(text, autoScroll = true) {
  const b = row(true);
  b.innerHTML = text;

  // âœ… ìë™ ìŠ¤í¬ë¡¤ ì˜µì…˜ì— ë”°ë¼ ì œì–´
  if (autoScroll) {
    chat.scrollTop = chat.scrollHeight;
  }

  return Promise.resolve(b);
}
function sayME(text) {
  const b = row(false);
  b.textContent = text;
  // âŒ ìë™ ìŠ¤í¬ë¡¤ ì œê±°
  return Promise.resolve();
}
/* ---------- Event ì•ˆë‚´ íŒì—… (í¬ê¸° ì¡°ì • + ì¤‘ì•™ í‘œì‹œ) ---------- */
function openEventPopup() {
  const overlay = document.getElementById('popupOverlay');
  const content = document.getElementById('popupContent');
  const box = document.getElementById('popupBox');
  box.classList.add('event-mode');
  overlay.style.display = 'flex';
  content.innerHTML = `
    <div class="event-msg">
      ğŸ <strong>ì´ë²¤íŠ¸ ì•ˆë‚´!</strong><br>
      ë‹¬ë ¥Â·ë‹¤ì´ì–´ë¦¬ë¥¼ ì œì™¸í•˜ê³  <strong>1ë§Œì› ì´ìƒ</strong> êµ¬ë§¤ ì‹œ<br>
      ë‹¬ë ¥Â·ë‹¤ì´ì–´ë¦¬ë¥¼ <strong>20% í• ì¸</strong>í•´ë“œë ¤ìš” âœ¨
    </div>
  `;
}

function showProducts(list){
  const deck = document.createElement('div');
  deck.className = 'deck';
  list.forEach(p => deck.appendChild(productCard(p)));
  chat.append(deck);

  }

/* ---------- Intent & filters ---------- */
function intentFrom(text){
  const t=text.toLowerCase();
  if(/(ë‹¬ë ¥|ìº˜ë¦°ë”)/.test(text)) return 'calendar';
  if(/(ë‹¤ì´ì–´ë¦¬|í”Œë˜ë„ˆ|ì €ë„)/.test(text)) return 'diary';
  return 'search';
}
function filterProducts({kind, subtype, tag}){
  return CATALOG.filter(p=>
    (kind? p.kind===kind : true) &&
    (subtype? p.subtype===subtype : true) &&
    (tag? (p.tags?.some(t=>t.includes(tag)) || p.name.includes(tag)) : true)
  );
}

/* ---------- Quick choices ---------- */
function addQuickChoices(kind){
  quick.innerHTML='';
  if(kind==='calendar'){
    ['ë¯¸ë‹ˆë©€','ì¼ëŸ¬ìŠ¤íŠ¸','ì—…ë¬´ìš©','ë²½ê±¸ì´','íƒìƒ','ì¼ë ¥'].forEach(t=> addPill(quick, t+' ë‹¬ë ¥'));
  }else if(kind==='diary'){
    ['ìœ„í´ë¦¬','ë°ì¼ë¦¬','ë¯¸ë‹ˆ','ê¾¸ë¯¸ê¸°','ìš°ì£¼','ê³ ì–‘ì´'].forEach(t=> addPill(quick, t+' ë‹¤ì´ì–´ë¦¬'));
  }else{
    ['ë‹¬ë ¥ ì°¾ê¸°','ë‹¤ì´ì–´ë¦¬ ì°¾ê¸°'].forEach(t=> addPill(quick, t));
  }
}
function addPill(container, text){
  const pill = document.createElement('button'); pill.className='pill'; pill.textContent=text;
  pill.onclick=()=>handleUser(text); container.appendChild(pill);
}

/* ---------- Popup ---------- */
const overlay=document.getElementById('popupOverlay');
const content=document.getElementById('popupContent');

function openPopup(p){
  content.innerHTML = `
    <div class="popup-title">${p.name}</div>
    <div class="popup-sub">${p.blurb||''}</div>
    <div class="popup-price">
<span class="sale-badge">ì¡°ê±´ ë‹¬ì„± ì‹œ í• ì¸</span>
      <div class="price-line"><del>â‚©${p.price.toLocaleString()}</del><span class="sale-amount">â‚©${p.sale.toLocaleString()}</span></div>
    </div>
    <div class="popup-tags">${(p.tags||[]).map(t=>`<span class="tag">${t}</span>`).join('')}</div>
    <div class="gallery">
      ${(p.gallery&&p.gallery.length?p.gallery:[p.img]).map(src=>`<img src="${src}" alt="ìƒì„¸ ì´ë¯¸ì§€" loading="lazy">`).join('')}
    </div>`;
  overlay.style.display='flex';
}
function closePopup() {
  document.getElementById('popupBox').classList.remove('event-mode'); // âœ… ì›ë˜ í¬ê¸°ë¡œ ë³µê·€
  overlay.style.display = 'none';
}

overlay.addEventListener('click', e=>{ if(e.target===overlay) closePopup(); });
document.addEventListener('keydown', e=>{ if(e.key==='Escape') closePopup(); });

/* ---------- Flow ---------- */

// âœ… ì˜¤ë¥¸ìª½ ME ë§í’ì„  ì•ˆì— ì„¸ë¡œí˜• ì„ íƒì§€ ë²„íŠ¼ ë¬¶ìŒì„ ê·¸ë¦¬ëŠ” ìœ í‹¸
function renderMeChoices(buttonLabels = []) {
  // âœ… "ì²˜ìŒìœ¼ë¡œ" ë²„íŠ¼ ì¶”ê°€
  const fullChoices = [...buttonLabels, 'ğŸ  ì²˜ìŒìœ¼ë¡œ'];

  const r = document.createElement('div');
  r.className = 'row';
  const a = document.createElement('div');
  a.className = 'avatar';
  a.textContent = 'ME';
  const b = document.createElement('div');
  b.className = 'bubble me';
  b.innerHTML = `
    <div class="choices vertical right">
      ${fullChoices.map(txt => `<button class="pill full">${txt}</button>`).join('')}
    </div>
  `;
  r.append(a, b);
  chat.append(r);

  // âœ… ë²„íŠ¼ í´ë¦­ ì‹œ ë™ì‘
  b.querySelectorAll('.pill').forEach(btn => {
    btn.onclick = async () => {
      const choice = btn.textContent.trim();

      if (choice.includes('ì²˜ìŒìœ¼ë¡œ')) {
        // ğŸ  ì²˜ìŒìœ¼ë¡œ
        chat.innerHTML = '';       // ëŒ€í™” ì´ˆê¸°í™”
        quick.innerHTML = '';      // ë¹ ë¥¸ ì„ íƒì§€ ì´ˆê¸°í™”
        disableComposer(false);    // ë²„íŠ¼ ë‹¤ì‹œ í™œì„±í™”
        intro();                   // ì¸íŠ¸ë¡œ ì¬ì‹œì‘
        return;
      }

      // ì¼ë°˜ ì„ íƒì§€ ì²˜ë¦¬
      await handleUser(choice);
    };
  });
}

function pickTag(text, candidates){ for(const c of candidates){ if(text.includes(c)) return c; } return undefined; }

// âœ… ìƒí’ˆ í‘œì‹œ í›„ ìë™ìœ¼ë¡œ "ğŸ  ì²˜ìŒìœ¼ë¡œ" ë²„íŠ¼ í‘œì‹œ
function showHomeAfterProducts(delay = 1000) {
  setTimeout(() => {
    renderMeChoices([]); // ë¹ˆ ì„ íƒì§€ â†’ "ğŸ  ì²˜ìŒìœ¼ë¡œ"ë§Œ í‘œì‹œë¨
  }, delay);
}

function handleUser(text) {
  disableComposer(true);
  // âœ… [ì´ë²¤íŠ¸ ë‚´ìš© ì„¤ëª…] ì„ íƒ ì‹œ
  if (/ì´ë²¤íŠ¸.*ê¶ê¸ˆ/.test(text)) {
    sayAI(`
      ğŸ‰ <strong>2026 ë‹¬ë ¥ & ë‹¤ì´ì–´ë¦¬ í• ì¸ ì´ë²¤íŠ¸</strong>ë¥¼ ìš”ì•½í•´ë“œë¦´ê²Œìš”.<br><br>
      ğŸ—“ <strong>ê¸°ê°„</strong>: 2025ë…„ 11ì›” 1ì¼(ê¸ˆ)ë¶€í„° ì†Œì§„ ì‹œê¹Œì§€<br>
      ğŸ‘¥ <strong>ëŒ€ìƒ</strong>: ì˜¤í”„ë¼ì¸ ë§¤ì¥ êµ¬ë§¤ ê³ ê°<br><br>
      ğŸ’¡ <strong>ë‚´ìš©</strong>:<br>
      - ë‹¬ë ¥Â·ë‹¤ì´ì–´ë¦¬ë¥¼ ì œì™¸í•œ ìƒí’ˆì„ <strong>1ë§Œ ì› ì´ìƒ</strong> êµ¬ë§¤ ì‹œ,<br>
      - <strong>2026ë…„ ë‹¬ë ¥ ë° ë‹¤ì´ì–´ë¦¬ ì „í’ˆëª© 20% í• ì¸</strong> ì ìš©<br><br>
      âš ï¸ <strong>ìœ ì˜ì‚¬í•­</strong>:<br>
      1. ë‹¬ë ¥/ë‹¤ì´ì–´ë¦¬ ëŸ­í‚¤ë°±ì€ í• ì¸ ì œì™¸<br>
      2. ë‹¬ë ¥Â·ë‹¤ì´ì–´ë¦¬ ë‹¨ë… êµ¬ë§¤ ë˜ëŠ” 1ë§Œ ì› ë¯¸ë§Œ êµ¬ë§¤ ì‹œ í• ì¸ ë¶ˆê°€<br><br>
      ğŸ“š ì¦‰, ë‹¤ë¥¸ ìƒí’ˆê³¼ í•¨ê»˜ êµ¬ë§¤í•˜ë©´ ë‹¬ë ¥Â·ë‹¤ì´ì–´ë¦¬ë¥¼ 20% ì €ë ´í•˜ê²Œ ì‚´ ìˆ˜ ìˆìŠµë‹ˆë‹¤ ğŸ˜Š
    `).then(() => {
      renderMeChoices([
        'ë‹¬ë ¥ì´ í•„ìš”í•´ìš”',
        'ë‹¤ì´ì–´ë¦¬ ë³´ê³ ì‹¶ì–´ìš”',
        'ì „ë¶€ ë³´ì—¬ì£¼ì„¸ìš”'
      ]);
      disableComposer(false);
    });
    return;
  }

  sayME(text);
  const intent = intentFrom(text);

  // âœ… â€œì „ë¶€ ë³´ì—¬ì£¼ì„¸ìš”â€ í´ë¦­ ì‹œ: ë‹¬ë ¥ + ë‹¤ì´ì–´ë¦¬ ì „ì²´ í‘œì‹œ
  if (/ì „ë¶€\s*ë³´ì—¬ì£¼ì„¸ìš”/.test(text)) {
    sayAI('ì¢‹ì•„ìš” ğŸŒŸ ë‹¬ë ¥ê³¼ ë‹¤ì´ì–´ë¦¬ë¥¼ ëª¨ë‘ ë³´ì—¬ë“œë¦´ê²Œìš”!').then(() => {
      const allItems = CATALOG.filter(p => p.kind === 'calendar' || p.kind === 'diary');
      showProducts(allItems);
      disableComposer(false);
      showHomeAfterProducts(); // âœ… ìƒí’ˆ í‘œì‹œ í›„ 1ì´ˆ ë’¤ "ğŸ  ì²˜ìŒìœ¼ë¡œ" ìë™ í‘œì‹œ
    });
    return;
  }

  // âœ… ë‹¬ë ¥ ê´€ë ¨ ë¶„ê¸°
  if (intent === 'calendar') {
    const calChoice = pickTag(text, ['ë¯¸ë‹ˆë©€', 'ì¼ëŸ¬ìŠ¤íŠ¸', 'ì—…ë¬´', 'ë²½ê±¸ì´', 'íƒìƒ', 'ì¼ë ¥', 'í•œêµ­í™”', 'ëª…í™”']);

    // âœ… ì„¸ë¶€ ì„ íƒ (ì˜ˆ: íƒìƒ ë‹¬ë ¥, ëª…í™” ë‹¬ë ¥ ë“±)
    if (calChoice) {
      const subtype =
        /íƒìƒ/.test(text) ? 'desk' :
        /ë²½ê±¸ì´/.test(text) ? 'wall' :
        /ì¼ë ¥/.test(text) ? 'tear' : undefined;
      const tag = ['ë¯¸ë‹ˆë©€', 'ì¼ëŸ¬ìŠ¤íŠ¸', 'ì—…ë¬´', 'í•œêµ­í™”', 'ëª…í™”'].includes(calChoice)
        ? calChoice
        : undefined;

      const list = filterProducts({ kind: 'calendar', subtype, tag });
      sayAI(`ìš”ì²­í•˜ì‹  <strong>${calChoice}</strong> ë‹¬ë ¥ì„ ì°¾ì•„ë´¤ì–´ìš”.`).then(() => {
        showProducts(list.length ? list : filterProducts({ kind: 'calendar' }));
        disableComposer(false);
        renderMeChoices([
          'ì¼ëŸ¬ìŠ¤íŠ¸ ë‹¬ë ¥',
          'ë²½ê±¸ì´ ë‹¬ë ¥',
          'íƒìƒ ë‹¬ë ¥',
          'ì¼ë ¥ ë‹¬ë ¥',
          'í•œêµ­í™” ë‹¬ë ¥',
          'ëª…í™” ë‹¬ë ¥'
        ]);
      });
      return;
    }

    // âœ… â€œë‹¬ë ¥ì´ í•„ìš”í•´ìš”â€ í´ë¦­ ì‹œ
    if (/ë‹¬ë ¥ì´ í•„ìš”/.test(text)) {
      sayAI('ì¢‹ì•„ìš” ğŸ˜Š ì¤€ë¹„ëœ ë‹¬ë ¥ë“¤ì„ ë¨¼ì € ë³´ì—¬ë“œë¦´ê²Œìš”.').then(() => {
        const allCalendars = filterProducts({ kind: 'calendar' });
        showProducts(allCalendars);
        return new Promise(resolve => setTimeout(resolve, 800));
      }).then(() => {
        return sayAI('ì›í•˜ì‹ ë‹¤ë©´ ì•„ë˜ì—ì„œ ì¢…ë¥˜ë¥¼ ê³¨ë¼ë³¼ ìˆ˜ë„ ìˆì–´ìš”.', false);
      }).then(() => {
        renderMeChoices([
          'ì¼ëŸ¬ìŠ¤íŠ¸ ë‹¬ë ¥',
          'ë²½ê±¸ì´ ë‹¬ë ¥',
          'íƒìƒ ë‹¬ë ¥',
          'ì¼ë ¥ ë‹¬ë ¥',
          'í•œêµ­í™” ë‹¬ë ¥',
          'ëª…í™” ë‹¬ë ¥'
        ]);
        disableComposer(false);
      });
      return;
    }

    // âœ… ê¸°íƒ€ ë‹¬ë ¥ ê´€ë ¨ ë¬¸ì¥
    sayAI('ì¢‹ì•„ìš” ğŸ˜Š ì–´ë–¤ ë‹¬ë ¥ì„ ì°¾ê³  ê³„ì‹ ê°€ìš”?').then(() => {
      renderMeChoices([
        'ì¼ëŸ¬ìŠ¤íŠ¸ ë‹¬ë ¥',
        'ë²½ê±¸ì´ ë‹¬ë ¥',
        'íƒìƒ ë‹¬ë ¥',
        'ì¼ë ¥ ë‹¬ë ¥',
        'í•œêµ­í™” ë‹¬ë ¥',
        'ëª…í™” ë‹¬ë ¥'
      ]);
      disableComposer(false);
    });
    return;
  }

  // âœ… ë‹¤ì´ì–´ë¦¬ ê´€ë ¨ ë¶„ê¸°
  if (intent === 'diary') {
    const dChoiceType = pickTag(text, ['ìœ„í´ë¦¬', 'ë°ì¼ë¦¬', 'ë¯¸ë‹ˆ']);
    const dChoiceTag  = pickTag(text, ['í”¼ë„ˆì¸ ', 'ê³ ì–‘ì´', 'NASA', 'ë¦¬ê³¡', 'ì•¨ë¦¬ìŠ¤', 'ì˜¬ë¦¬ë¸Œ', 'ê¾¸ë¯¸ê¸°', 'ìš°ì£¼']);

    // âœ… ì„¸ë¶€ ì„ íƒ (ì˜ˆ: ìœ„í´ë¦¬ ë‹¤ì´ì–´ë¦¬, í”¼ë„ˆì¸  ë‹¤ì´ì–´ë¦¬ ë“±)
    if (dChoiceType || dChoiceTag) {
      const subtype =
        /ìœ„í´ë¦¬/.test(text) ? 'weekly' :
        /ë°ì¼ë¦¬/.test(text) ? 'daily' :
        /ë¯¸ë‹ˆ/.test(text) ? 'mini' : undefined;
      const tag = dChoiceTag;
      const list = filterProducts({ kind: 'diary', subtype, tag });

      sayAI('ìš”ì²­í•˜ì‹  ì¡°ê±´ì— ë§ì¶° ì°¾ì•„ë´¤ì–´ìš”.').then(() => {
        showProducts(list.length ? list : filterProducts({ kind: 'diary' }));
        disableComposer(false);
        renderMeChoices([
          'ìœ„í´ë¦¬ ë‹¤ì´ì–´ë¦¬',
          'ë°ì¼ë¦¬ ë‹¤ì´ì–´ë¦¬',
          'ë¯¸ë‹ˆ ë‹¤ì´ì–´ë¦¬',
          'í”¼ë„ˆì¸  ë‹¤ì´ì–´ë¦¬',
          'ê³ ì–‘ì´ ë‹¤ì´ì–´ë¦¬',
          'NASA ë‹¤ì´ì–´ë¦¬'
        ]);
      });
      return;
    }

    // âœ… â€œë‹¤ì´ì–´ë¦¬ ë³´ê³ ì‹¶ì–´ìš”â€ í´ë¦­ ì‹œ
    if (/ë‹¤ì´ì–´ë¦¬ ë³´/.test(text)) {
      sayAI('ì¢‹ì•„ìš” âœ¨ ë‹¤ì–‘í•œ ë‹¤ì´ì–´ë¦¬ë¥¼ ë¨¼ì € ë³´ì—¬ë“œë¦´ê²Œìš”.').then(() => {
        const allDiaries = filterProducts({ kind: 'diary' });
        showProducts(allDiaries);
        return new Promise(resolve => setTimeout(resolve, 800));
      }).then(() => {
        return sayAI('ì›í•˜ì‹ ë‹¤ë©´ ì•„ë˜ì—ì„œ ì¢…ë¥˜ë¥¼ ê³¨ë¼ë³¼ ìˆ˜ë„ ìˆì–´ìš”.', false);
      }).then(() => {
        renderMeChoices([
          'ìœ„í´ë¦¬ ë‹¤ì´ì–´ë¦¬',
          'ë°ì¼ë¦¬ ë‹¤ì´ì–´ë¦¬',
          'ë¯¸ë‹ˆ ë‹¤ì´ì–´ë¦¬',
          'í”¼ë„ˆì¸  ë‹¤ì´ì–´ë¦¬',
          'ê³ ì–‘ì´ ë‹¤ì´ì–´ë¦¬',
          'NASA ë‹¤ì´ì–´ë¦¬'
        ]);
        disableComposer(false);
      });
      return;
    }

    // âœ… ê¸°íƒ€ ë‹¤ì´ì–´ë¦¬ ê´€ë ¨ ë¬¸ì¥
    sayAI('ì¢‹ì•„ìš” ğŸ˜Š ì–´ë–¤ ë‹¤ì´ì–´ë¦¬ë¥¼ ì°¾ê³  ê³„ì‹ ê°€ìš”?').then(() => {
      renderMeChoices([
        'ìœ„í´ë¦¬ ë‹¤ì´ì–´ë¦¬',
        'ë°ì¼ë¦¬ ë‹¤ì´ì–´ë¦¬',
        'ë¯¸ë‹ˆ ë‹¤ì´ì–´ë¦¬',
        'í”¼ë„ˆì¸  ë‹¤ì´ì–´ë¦¬',
        'ê³ ì–‘ì´ ë‹¤ì´ì–´ë¦¬',
        'NASA ë‹¤ì´ì–´ë¦¬'
      ]);
      disableComposer(false);
    });
    return;
  }

  // âœ… ê¸°ë³¸ ì‘ë‹µ (ë‹¬ë ¥/ë‹¤ì´ì–´ë¦¬ ì™¸)
  sayAI('ì¢‹ì•„ìš” ğŸ˜Š ì–´ë–¤ ìƒí’ˆì„ ë³´ê³  ì‹¶ìœ¼ì‹ ê°€ìš”?').then(() => {
    renderMeChoices(['ë‹¬ë ¥ì´ í•„ìš”í•´ìš”', 'ë‹¤ì´ì–´ë¦¬ ë³´ê³ ì‹¶ì–´ìš”', 'ì „ë¶€ ë³´ì—¬ì£¼ì„¸ìš”']);
    disableComposer(false);
  });
}
function disableComposer(dis){
  [...document.querySelectorAll('.pill')].forEach(p=>p.disabled=dis);
}

/* ---------- Rail populate & Intro ---------- */
function populateRail() {
  // ë¹ ë¥¸ ì‹œì‘ ê·¸ëŒ€ë¡œ
  const s = document.getElementById('starts');
  s.innerHTML = '';
  STARTS.forEach(x => addPill(s, x.q));

  // ëŒ€í™” ì„ íƒì§€ ê·¸ë£¹ ë Œë”
  const f = document.getElementById('filters');
  f.innerHTML = '';

  // ì •ê·œì‹: ë‹¤ì´ì–´ë¦¬ ìª½ í‚¤ì›Œë“œ
  const diaryRe = /(ìœ„í´ë¦¬|ë°ì¼ë¦¬|ë¯¸ë‹ˆ|í”¼ë„ˆì¸ |ê³ ì–‘ì´|NASA|ë¦¬ê³¡|ì•¨ë¦¬ìŠ¤|ì˜¬ë¦¬ë¸Œ)/;

  const groups = [
    { title: 'ë‹¬ë ¥',   kind: 'calendar', items: FILTERS.filter(t => !diaryRe.test(t)) },
    { title: 'ë‹¤ì´ì–´ë¦¬', kind: 'diary',   items: FILTERS.filter(t =>  diaryRe.test(t)) },
  ];

  // í•œêµ­ì–´ ì •ë ¬(ê°€ë‚˜ë‹¤) ë³´ì¥
  const sortKo = (a, b) => a.localeCompare(b, 'ko');

  groups.forEach(g => {
    const items = g.items.slice().sort(sortKo);

    // ì†Œì œëª©
    const head = document.createElement('div');
    head.className = 'subhead';
    head.textContent = g.title;

    // ë²„íŠ¼ ë¬¶ìŒ
    const wrap = document.createElement('div');
    wrap.className = 'choices';

    // ì‹¤ì œ ë§¤ì¹­ë˜ëŠ” ê²ƒë§Œ ë²„íŠ¼ ìƒì„±
    items.forEach(t => {
      const queryText = g.kind === 'diary' ? `${t} ë‹¤ì´ì–´ë¦¬` : `${t} ë‹¬ë ¥`;

      const tagMatch = CATALOG.some(p =>
        p.kind === g.kind && (
          (p.tags && p.tags.some(tag => tag.includes(t))) ||
          p.name.includes(t)
        )
      );

      if (tagMatch) addPill(wrap, queryText);
    });

    // í•´ë‹¹ ê·¸ë£¹ì— í‘œì‹œí•  ë²„íŠ¼ì´ ìˆìœ¼ë©´ DOMì— ì¶”ê°€
    if (wrap.children.length > 0) {
      f.appendChild(head);
      f.appendChild(wrap);
    }
  });
}
function intro() {
  const greetings = [
    "ì•ˆë…•í•˜ì„¸ìš” ğŸ˜Š ìƒˆí•´ ì¤€ë¹„ ë„ì™€ë“œë¦´ê²Œìš”.",
    "ì–´ì„œì˜¤ì„¸ìš” ğŸ“– ì˜¤ëŠ˜ì€ ì–´ë–¤ ë‹¤ì´ì–´ë¦¬ë¥¼ ì°¾ìœ¼ì‹œë‚˜ìš”?",
    "ë°˜ê°€ì›Œìš” âœ¨ 2026 ìƒˆí•´ ë‹¬ë ¥ë¶€í„° ì‚´í´ë³¼ê¹Œìš”?"
  ];
  const greet = greetings[Math.floor(Math.random() * greetings.length)];

  const eventMsg = `
    <div class="event-msg">
      ğŸ <strong>ì´ë²¤íŠ¸ ì•ˆë‚´!</strong><br>
      ë‹¬ë ¥Â·ë‹¤ì´ì–´ë¦¬ë¥¼ ì œì™¸í•˜ê³  <strong>1ë§Œì› ì´ìƒ</strong> êµ¬ë§¤ ì‹œ<br>
      ë‹¬ë ¥Â·ë‹¤ì´ì–´ë¦¬ë¥¼ <strong>20% í• ì¸</strong>í•´ë“œë ¤ìš” âœ¨
    </div>
  `;

  // âœ… ìˆœì„œ: ì´ë²¤íŠ¸ ë¬¸êµ¬ â†’ ì¸ì‚¬ â†’ ì„ íƒì§€ í‘œì‹œ
  sayAI('ğŸ“¢ ì§„í–‰ì¤‘ì¸ ì´ë²¤íŠ¸ë¥¼ í™•ì¸í•´ì£¼ì„¸ìš”!')
  .then(() => sayAI(eventMsg))
  .then(() => sayAI(greet))
  .then(() => {
    renderMeChoices([
      'ğŸ“¢ ì´ë²¤íŠ¸ê°€ ê¶ê¸ˆí•´ìš”',
      'ë‹¬ë ¥ì´ í•„ìš”í•´ìš”',
      'ë‹¤ì´ì–´ë¦¬ ë³´ê³ ì‹¶ì–´ìš”',
      'ì „ë¶€ ë³´ì—¬ì£¼ì„¸ìš”'
    ]);
  });

}

/* boot */
populateRail();
intro();
/* ---------- ê´€ë¦¬ì ëª¨ë“œ ---------- */
const adminPanel = document.getElementById('adminPanel');
const adminList = document.getElementById('adminList');

// âœ… localStorageì—ì„œ í’ˆì ˆ ì •ë³´ ë¶ˆëŸ¬ì˜¤ê¸°
let soldOutList = JSON.parse(localStorage.getItem('SOLD_OUT') || '{}');

// âœ… ê´€ë¦¬ì ë¹„ë°€ë²ˆí˜¸ ì„¤ì • (ì›í•˜ë©´ ë°”ê¿”ë„ ë¨)
const ADMIN_PASSWORD = "1234";

// âœ… ê´€ë¦¬ì ëª¨ë“œ í† ê¸€ (ë¹„ë°€ë²ˆí˜¸ ì¶”ê°€)
function toggleAdmin() {
  // í˜„ì¬ ë‹«íŒ ìƒíƒœë¼ë©´ â†’ ë¹„ë°€ë²ˆí˜¸ í™•ì¸ í›„ ì—´ê¸°
  if (adminPanel.style.display !== 'block') {
    const input = prompt("ğŸ” ê´€ë¦¬ì ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•˜ì„¸ìš”:");
    if (input === null) return; // ì·¨ì†Œ ì‹œ ì•„ë¬´ ê²ƒë„ ì•ˆ í•¨
    if (input.trim() !== ADMIN_PASSWORD) {
      alert("âŒ ë¹„ë°€ë²ˆí˜¸ê°€ ì˜¬ë°”ë¥´ì§€ ì•ŠìŠµë‹ˆë‹¤.");
      return;
    }
  }

  // ë¹„ë°€ë²ˆí˜¸ í™•ì¸ í›„ í† ê¸€ ë™ì‘
  adminPanel.style.display = adminPanel.style.display === 'block' ? 'none' : 'block';
  if (adminPanel.style.display === 'block') renderAdminList();
}

// âœ… ê´€ë¦¬ì ë¦¬ìŠ¤íŠ¸ ë Œë”ë§
function renderAdminList() {
  adminList.innerHTML = '';
  CATALOG.forEach(p => {
    const item = document.createElement('div');
    item.className = 'admin-item';
    item.innerHTML = `
      <label>${p.name}</label>
      <input type="checkbox" ${soldOutList[p.eng] ? 'checked' : ''} data-eng="${p.eng}">
    `;
    adminList.appendChild(item);
  });
}

// âœ… ì €ì¥ ë²„íŠ¼ í´ë¦­ ì‹œ
function saveSoldOut() {
  const inputs = adminList.querySelectorAll('input[type=checkbox]');
  soldOutList = {};
  inputs.forEach(i => {
    if (i.checked) soldOutList[i.dataset.eng] = true;
  });
  localStorage.setItem('SOLD_OUT', JSON.stringify(soldOutList));
  alert('âœ… í’ˆì ˆ ì •ë³´ê°€ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤.');
  adminPanel.style.display = 'none';
  // ìƒí’ˆ í‘œì‹œ ê°±ì‹ 
  document.querySelectorAll('.deck').forEach(deck => deck.remove());
  sayAI('í’ˆì ˆ ìƒíƒœê°€ ë°˜ì˜ë˜ì—ˆìŠµë‹ˆë‹¤.').then(() => intro());
}

/* ---------- ìƒí’ˆ í´ë¦­ íšŸìˆ˜ ê´€ë¦¬ ---------- */
let clickCounts = JSON.parse(localStorage.getItem('CLICK_COUNTS') || '{}');

// âœ… ìƒí’ˆ í´ë¦­ ì‹œ ì¹´ìš´íŠ¸ ì¦ê°€
function recordProductClick(id) {
  clickCounts[id] = (clickCounts[id] || 0) + 1;
  localStorage.setItem('CLICK_COUNTS', JSON.stringify(clickCounts));
}

// âœ… ê´€ë¦¬ì ëª¨ë“œì—ì„œ í´ë¦­ íšŸìˆ˜ í‘œì‹œ
function renderClickStats() {
  adminList.innerHTML = ''; // ê¸°ì¡´ ëª©ë¡ ì§€ì›€

  const list = Object.keys(clickCounts);
  if (list.length === 0) {
    adminList.innerHTML = '<p style="font-size:13px;color:#666;">ì•„ì§ í´ë¦­ëœ ìƒí’ˆì´ ì—†ìŠµë‹ˆë‹¤.</p>';
    return;
  }

  list.forEach(id => {
    const product = CATALOG.find(p => p.eng === id);
    const name = product ? product.name : id;
    const count = clickCounts[id];

    const item = document.createElement('div');
    item.className = 'admin-item';
    item.innerHTML = `
      <span>${name}</span>
      <span style="font-weight:600;">${count}íšŒ</span>
    `;
    adminList.appendChild(item);
  });
}

// âœ… í´ë¦­ìˆ˜ ì´ˆê¸°í™”
function resetClickStats() {
  if (confirm('ì •ë§ ëª¨ë“  í´ë¦­ ê¸°ë¡ì„ ì´ˆê¸°í™”í• ê¹Œìš”?')) {
    clickCounts = {};
    localStorage.removeItem('CLICK_COUNTS');
    alert('âœ… í´ë¦­ ê¸°ë¡ì´ ëª¨ë‘ ì´ˆê¸°í™”ë˜ì—ˆìŠµë‹ˆë‹¤.');
    renderClickStats();
  }
}


/* ---------- í’ˆì ˆ ìƒíƒœ ë°˜ì˜ ---------- */
function productCard(p) {
  const card = document.createElement('div');
  card.className = 'card';
  const thWrap = document.createElement('div');
  thWrap.className = 'thumb-wrap';
  const th = document.createElement('div');
  th.className = 'thumb';

  const img = new Image();
  img.src = p.img;
  img.alt = p.name;
  img.loading = 'eager';
  img.onclick = () => {
  if (!soldOutList[p.eng]) {
    recordProductClick(p.eng); // âœ… í´ë¦­ íšŸìˆ˜ ì¦ê°€
    openPopup(p);
  }
};

  th.appendChild(img);

  // í• ì¸ ë°°ì§€
  if (p.discount) {
    const badge = document.createElement('div');
    badge.className = 'badge';
    badge.textContent = p.discount + '% OFF';
    thWrap.appendChild(badge);
  }

  // âœ… í’ˆì ˆ ìƒíƒœ í‘œì‹œ
  if (soldOutList[p.eng]) {
    const sold = document.createElement('div');
    sold.className = 'soldout-overlay';
    sold.textContent = 'í’ˆì ˆ';
    thWrap.appendChild(sold);
  }

  thWrap.appendChild(th);
  card.appendChild(thWrap);

  const meta = document.createElement('div');
  meta.className = 'meta';
  const name = document.createElement('div');
  name.className = 'name';
  name.textContent = p.name;
  meta.appendChild(name);
  const tagline = document.createElement('div');
  tagline.className = 'tagline';
  tagline.textContent = p.blurb || '';
  meta.appendChild(tagline);

  const price = document.createElement('div');
  price.className = 'price';
  price.innerHTML = `
    <div class="sale-badge">
      <span class="cond-tag" onclick="openEventPopup()">ì¡°ê±´</span>
      <span class="sale-text">ë‹¬ì„± ì‹œ í• ì¸</span>
    </div>
    <div class="price-line">
      <del>â‚©${p.price.toLocaleString()}</del>
      <span class="sale-amount">â‚©${p.sale.toLocaleString()}</span>
    </div>`;
  meta.appendChild(price);

  const tags = document.createElement('div');
  tags.className = 'tags';
  p.tags?.slice(0, 4).forEach(t => {
    const s = document.createElement('span');
    s.className = 'tag';
    s.textContent = t;
    tags.appendChild(s);
  });
  meta.appendChild(tags);

  card.appendChild(meta);
  return card;
}
/* ---------- ëŒ€ê¸° í™”ë©´ ìŠ¬ë¼ì´ë“œ ---------- */
const slides = document.querySelectorAll('#standbyScreen .slideshow img');
let currentSlide = 0;

setInterval(() => {
  slides[currentSlide].classList.remove('active');
  currentSlide = (currentSlide + 1) % slides.length;
  slides[currentSlide].classList.add('active');
}, 7000); // 4ì´ˆ ê°„ê²© ì „í™˜

// ë²„íŠ¼ í´ë¦­ ì‹œ ëŒ€ê¸° í™”ë©´ â†’ ëŒ€í™”ì°½ ì „í™˜
document.getElementById('enterButton').addEventListener('click', () => {
  const standby = document.getElementById('standbyScreen');
  const main = document.querySelector('main');
  const header = document.querySelector('header');

  // âœ… ëŒ€ê¸°í™”ë©´ ì„œì„œíˆ ì‚¬ë¼ì§
  standby.style.transition = 'opacity 1s ease';
  standby.style.opacity = '0';

  setTimeout(() => {
    standby.style.display = 'none';

    // âœ… header + main í•¨ê»˜ ì„œì„œíˆ ë‚˜íƒ€ë‚¨
    [header, main].forEach(el => {
      el.style.display = el.tagName === 'MAIN' ? 'grid' : 'block';
      el.style.opacity = '0';
      el.style.transition = 'opacity 1s ease';
      setTimeout(() => (el.style.opacity = '1'), 50);
    });
  }, 1000);
});

// í˜ì´ì§€ ë¡œë“œì‹œ ëŒ€í™”ì°½ & í—¤ë” ìˆ¨ê¸°ê¸°
document.addEventListener('DOMContentLoaded', () => {
  document.querySelector('main').style.display = 'none';
  document.querySelector('header').style.display = 'none';
});
/* ---------- ìë™ ëŒ€ê¸° í™”ë©´ ì „í™˜ (10ì´ˆ ë¬´í™œë™ ì‹œ) ---------- */
let idleTimer;
const IDLE_TIME = 10000; // 10ì´ˆ

function resetIdleTimer() {
  clearTimeout(idleTimer);
  idleTimer = setTimeout(showStandbyScreen, IDLE_TIME);
}

// ğŸ’¤ ëŒ€ê¸°í™”ë©´ ë³µê·€ í•¨ìˆ˜
function showStandbyScreen() {
  const standby = document.getElementById('standbyScreen');
  const main = document.querySelector('main');
  const header = document.querySelector('header');

  // âœ… íŒì—…ì´ ì—´ë ¤ìˆë‹¤ë©´ ë‹«ê¸°
  const overlay = document.getElementById('popupOverlay');
  if (overlay && overlay.style.display === 'flex') {
    closePopup();
  }

  // ëŒ€í™”ì°½ ìˆ¨ê¸°ê³  ëŒ€ê¸°í™”ë©´ í‘œì‹œ
  [header, main].forEach(el => {
    el.style.transition = 'opacity 0.8s ease';
    el.style.opacity = '0';
  });

  setTimeout(() => {
  // âœ… ëŒ€í™”ì°½ ì´ˆê¸°í™”
  chat.innerHTML = '';
  quick.innerHTML = '';
  
  // âœ… ê¸°ë³¸ ëŒ€í™” ì¬ì‹œì‘ (ì¸íŠ¸ë¡œ ì¬ì‹¤í–‰)
  intro();

  header.style.display = 'none';
  main.style.display = 'none';
  standby.style.display = 'flex';
  standby.style.opacity = '0';
  standby.style.transition = 'opacity 1s ease';
  setTimeout(() => (standby.style.opacity = '1'), 50);
}, 800);

}

// âœ… ì‚¬ìš©ì ë™ì‘ ê°ì§€ (ë§ˆìš°ìŠ¤/í„°ì¹˜/í‚¤ë³´ë“œ ë“±)
['mousemove', 'mousedown', 'keydown', 'touchstart'].forEach(event => {
  document.addEventListener(event, resetIdleTimer, false);
});

// âœ… ëŒ€í™” ì‹œì‘ ì‹œ íƒ€ì´ë¨¸ ì´ˆê¸°í™”
resetIdleTimer();

</script>

</body>
</html>